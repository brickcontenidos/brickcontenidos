<!DOCTYPE html>
<html lang="es" class="scroll-smooth">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>BRICK | Construí tu Historia Cinematográfica</title>

  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Google Fonts: Inter -->
  <link rel="preconnect" href="https://fonts.googleapis.com"/>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;900&display=swap" rel="stylesheet"/>

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"/>

  <style>
    body { font-family: 'Inter', sans-serif; background-color: #0a0a0a; }
    .bg-brick-red { background-color: #E63946; } .text-brick-red { color: #E63946; }
    .border-brick-red { border-color: #E63946; } .ring-brick-red { --tw-ring-color: #E63946; }

    .video-background-container{ position:relative;width:100vw;height:70vh;overflow:hidden;}
    .video-background-container iframe{ position:absolute;top:50%;left:50%;width:177.77vh;min-width:100vw;height:56.25vw;min-height:100vh;transform:translate(-50%,-50%);pointer-events:none;}
    .video-overlay{ position:absolute;inset:0;background:linear-gradient(to top,#0a0a0a 5%,rgba(0,0,0,.6) 50%,#0a0a0a 95%);}

    .section-hidden{display:none;} .section-visible{display:block;animation:fadeIn .8s ease-out forwards;}
    @keyframes fadeIn{from{opacity:0;transform:translateY(20px);}to{opacity:1;transform:translateY(0);}}

    .movie-poster-card{ aspect-ratio:3/4;background-size:cover;background-position:center;transition:transform .3s ease, box-shadow .3s ease;}
    .movie-poster-card:hover{ transform:scale(1.05); box-shadow:0 10px 30px rgba(0,0,0,.5);}
    .movie-poster-overlay{ background:linear-gradient(to top,rgba(0,0,0,.9) 10%,transparent 50%);}

    .badge-promo{ position:absolute; top:12px; right:12px; background:#E63946; color:#fff; font-weight:800; font-size:.72rem; padding:.25rem .5rem; border-radius:.375rem; box-shadow:0 6px 20px rgba(230,57,70,.35); }
  </style>
</head>
<body class="text-white">

  <!-- HERO -->
  <header class="video-background-container">
    <iframe id="hero-video-iframe" src="https://www.youtube.com/embed/fJIMPigDzgg?autoplay=1&mute=1&loop=1&playlist=fJIMPigDzgg&controls=0&showinfo=0&autohide=1&modestbranding=1&vq=hd1080" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>
    <div class="video-overlay"></div>
    <div class="relative z-10 flex flex-col items-center justify-center h-full text-center p-4">
      <img src="./img/logo-brick-white.png" alt="Logo de BRICK" class="h-16 mb-4" onerror="this.onerror=null;this.src='https://placehold.co/200x64/0a0a0a/ffffff?text=BRICK';">
      <h1 class="text-4xl md:text-6xl font-black tracking-tight leading-tight">Construyamos tu historia.</h1>
      <p class="text-lg md:text-xl text-gray-300 mt-2">Cada marca tiene una película esperando ser contada.</p>
      <a href="#step1" class="mt-8 bg-brick-red text-white font-bold py-3 px-8 rounded-lg text-lg hover:bg-red-700 transition-all duration-300">Empezar</a>
    </div>
  </header>

  <main class="container mx-auto">

    <!-- LADRILLO 1 -->
    <section id="step1" class="py-16">
      <div class="px-4 md:px-8 text-center">
        <h2 class="text-3xl font-bold mb-2">Ladrillo Uno: GÉNERO</h2>
        <p class="text-gray-400 mb-12">Toda película empieza con un género. En BRICK, el género es el universo donde vive tu marca. Elegilo y nosotros escribimos el guion.</p>
        <div id="genre-selector" class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-4 md:gap-6 max-w-7xl mx-auto"></div>
      </div>
    </section>

    <!-- LADRILLO 2 -->
    <section id="step2" class="py-16 section-hidden">
      <div class="px-4 md:px-8 text-center">
        <h2 class="text-3xl font-bold mb-2">Ladrillo Dos: Elegí tu escenario</h2>
        <p class="text-gray-400 mb-12">¿En qué punto de la historia se encuentra tu marca?</p>
        <div id="scenario-container" class="grid md:grid-cols-2 lg:grid-cols-3 gap-8 max-w-6xl mx-auto"></div>
      </div>
    </section>

    <!-- LADRILLO 3 -->
    <section id="step3" class="py-16 section-hidden">
      <div class="px-4 md:px-8 text-center">
        <h2 id="step3-title" class="text-3xl font-bold mb-2">Ladrillo Tres: Definí el nivel</h2>
        <p id="step3-subtitle" class="text-gray-400 mb-12">Desde una escena clave hasta una superproducción.</p>
        <div id="level-container" class="grid md:grid-cols-3 gap-8"></div>
      </div>
    </section>

    <!-- LADRILLO FINAL (Steps 4 and 5 combined) -->
    <section id="step5" class="py-16 section-hidden">
      <div class="px-4 md:px-8">
        <h2 class="text-3xl font-bold mb-12 text-center">Corte Final: Tu Plan de Producción Orientativo</h2>
        <div class="grid lg:grid-cols-5 gap-8 max-w-7xl mx-auto">
          
          <!-- Summary and Addons (Left) -->
          <div class="lg:col-span-3 bg-gray-900 p-6 md:p-8 rounded-lg">
            <h3 class="font-bold text-xl mb-4">Resumen de Producción</h3>
            <div id="summary-content" class="text-gray-300 space-y-4">
              <p class="text-gray-500">Completá los pasos para ver tu plan de producción.</p>
            </div>
            <div id="addons-container" class="mt-6">
              <!-- Addons will be rendered here by JS -->
            </div>
          </div>

          <!-- Form (Right) -->
          <div class="lg:col-span-2">
            <div class="bg-gray-900 p-6 md:p-8 rounded-lg h-full flex flex-col">
              <h3 class="font-bold text-xl mb-4">Completá tus datos para agendar una charla</h3>
              <p class="text-gray-400 mb-6">Nuestro equipo se comunicará con vos para coordinar una <strong>reunión gratuita</strong> y darle vida a tu proyecto.</p>
              
              <!-- ===== FORMULARIO MODIFICADO PARA NETLIFY ===== -->
              <form id="client-form" name="solicitud-produccion" method="POST" data-netlify="true" class="flex flex-col flex-grow">
                <div class="mb-4">
                  <label for="client-name" class="block text-gray-400 mb-1">Tu Nombre (Director/a)</label>
                  <input type="text" id="client-name" name="nombre" class="w-full bg-gray-800 border border-gray-700 rounded-md p-3 focus:outline-none focus:ring-2 focus:ring-brick-red" required>
                </div>
                <div class="mb-4">
                  <label for="client-email" class="block text-gray-400 mb-1">Tu Email de Contacto</label>
                  <input type="email" id="client-email" name="email" class="w-full bg-gray-800 border border-gray-700 rounded-md p-3 focus:outline-none focus:ring-2 focus:ring-brick-red" required>
                </div>
                <div class="mb-6">
                  <label for="client-business" class="block text-gray-400 mb-1">Nombre de tu Producción (Tu Marca)</label>
                  <input type="text" id="client-business" name="marca" class="w-full bg-gray-800 border border-gray-700 rounded-md p-3 focus:outline-none focus:ring-2 focus:ring-brick-red" required>
                </div>
                
                <!-- Campo oculto para enviar el resumen a Netlify -->
                <input type="hidden" name="resumen_produccion" id="hidden-summary-input">

                <div class="flex flex-col sm:flex-row gap-4 mt-auto">
                  <button type="submit" id="submit-button" class="w-full bg-brick-red text-white font-bold text-lg py-3 px-4 rounded-lg hover:bg-red-700 transition-all duration-300 disabled:bg-gray-600 disabled:cursor-not-allowed" disabled>Solicitar Reunión Creativa</button>
                  <button type="button" id="share-button" class="w-full sm:w-auto bg-gray-700 text-white font-bold text-lg py-3 px-6 rounded-lg hover:bg-gray-600 transition-all duration-300 disabled:bg-gray-800 disabled:cursor-not-allowed flex items-center justify-center gap-2" disabled>
                    <i class="fas fa-share-alt"></i> Compartir
                  </button>
                </div>
              </form>
              <!-- ===== FIN DEL FORMULARIO MODIFICADO ===== -->

            </div>
          </div>

        </div>
      </div>
    </section>
  </main>

  <footer class="text-center py-8 border-t border-gray-800 mt-16">
    <p>&copy; 2025 BRICK. Todos los derechos reservados.</p>
    <div class="flex justify-center space-x-4 mt-4 text-gray-400">
      <a href="#" class="hover:text-brick-red"><i class="fab fa-instagram"></i> Instagram</a>
      <a href="#" class="hover:text-brick-red"><i class="fab fa-youtube"></i> YouTube</a>
    </div>
  </footer>

  <!-- Modal Compartir -->
  <div id="share-modal" class="fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center p-4 hidden z-50">
    <div class="bg-gray-800 rounded-lg p-8 max-w-lg w-full text-center relative">
      <button id="close-modal-button" class="absolute top-4 right-4 text-gray-400 hover:text-white text-2xl leading-none">&times;</button>
      <h2 class="text-2xl font-bold mb-4">Compartí tu Hoja de Rodaje</h2>
      <p class="text-gray-300 mb-6">Copiá este link para guardar tu selección o compartirla con tu equipo.</p>
      <div class="flex items-center bg-gray-900 rounded-lg p-2">
        <input type="text" id="share-link-input" class="bg-transparent text-gray-300 w-full p-2 outline-none" readonly>
        <button id="copy-link-button" class="bg-brick-red text-white font-bold py-2 px-4 rounded-lg hover:bg-red-700">Copiar</button>
      </div>
    </div>
  </div>

  <script>
  document.addEventListener('DOMContentLoaded', () => {
    // ======================= CONTENIDO EDITABLE =======================
    const serviceData = {
      culinario: {
        name: "Culinario",
        icon: "fa-utensils",
        videoId: "fJIMPigDzgg", // reemplazar por ID propio
        image: "./img/genero-culinario.jpg",
        storyIntro: "Puede que seas un restaurante, una cafetería, un chef o un productor artesanal. Vamos a elegir la escena donde tu cocina vuelve protagonista.",
        clients: ["Restaurante/Bar","Cafetería/Pastelería","Food Truck","Dark Kitchen","Chef/Catering","Bodega/Vinoteca","Alimentos artesanales"],
        scenarios: [
          { name: "Menú de Estreno", desc: "Soy nuevo o renové mi carta y necesito fotos y videos de mis platos para mis redes y apps de delivery. ¡Urgente!" },
          { name: "Sabor que Conecta", desc: "Quiero que mis seguidores conecten con la historia detrás de mi marca. No se trata solo de los platos, sino de la narrativa, la experiencia del lugar y la pasión que ponemos en cada detalle." },
          { name: "Solo Edición", desc: "Ya tengo un montón de fotos y videos, pero necesito que un profesional les dé vida y los edite de forma atractiva y profesional." },
          { name: "Guion Abierto", desc: "Tengo otra idea en mente o me gustaría explorar las posibilidades juntos." }
        ],
        levels: {
          express: { name: "Producción Express", icon: "fa-bolt", promo: true,
            desc: "<strong>Entregables:</strong> Fotos de 10 platos clave, 5 videos para redes y contenido para apps. <strong>Rodaje:</strong> 1 persona, 3-4 horas, sin luces ni sonido externo. <strong>Promo Lanzamiento:</strong> 10 cupos a AR$ 295.000. “1 día de rodaje = 1 mes de contenido”."
          },
          indie: { name: "Producción Indie", icon: "fa-film",
            desc: "<strong>Entregables:</strong> Cobertura fotográfica de todo el menú y videos de preparación. <strong>Rodaje:</strong> 1-2 personas, 5-6 horas, con iluminación básica."
          },
          estelar: { name: "Producción Estelar", icon: "fa-star",
            desc: "<strong>Entregables:</strong> Un fashion film gastronómico con look de cine y cámara lenta. <strong>Rodaje:</strong> Equipo completo, jornada completa, iluminación pro y estabilizador."
          }
        },
        storytellingLevels: {
            express: { name: "Rodaje con Guion para Redes", icon: "fa-bolt", promo: true,
                desc: "Contamos una historia guionada para tus redes. Ideal para mostrar la esencia de tu marca de forma rápida y efectiva. <strong>Rodaje:</strong> 1 persona, 3-4 horas. <strong>Promo Lanzamiento:</strong> 10 cupos a AR$ 295.000."
            },
            indie: { name: "Co-creación de Contenido", icon: "fa-film",
                desc: "Desarrollamos juntos ideas de contenido guionadas. Las aprobás y luego las filmamos en tu locación con un equipo profesional."
            },
            estelar: { name: "Campaña 360", icon: "fa-star",
                desc: "Producimos una historia central para tu marca que se despliega en redes como una campaña 360, con un claro objetivo de marketing. Producción completa."
            }
        },
        editingLevels: {
          dinamica: { name: "Edición Express", icon: "fa-cut",
            desc: "<strong>Entrega:</strong> Hasta 10 piezas. Corte limpio, color y audio básico. <strong>Uso:</strong> Reels/Stories/Feed."
          },
          narrativa: { name: "Montaje Narrativo", icon: "fa-film",
            desc: "<strong>Entrega:</strong> Hasta 15 piezas con storytelling (plato/chef/local). Ritmo y transiciones."
          },
          estrategica: { name: "Edición de Campaña", icon: "fa-magic",
            desc: "<strong>Entrega:</strong> Hasta 20 piezas multiformato. Enfoque en promos/lanzamientos y ads."
          }
        },
        addons: [
          { name: "Lentes Macro (Detalles)", icon: "fa-search-plus" },
          { name: "Cámara Lenta (Texturas)", icon: "fa-forward-step" },
          { name: "Video-Entrevista al Chef", icon: "fa-microphone" },
          { name: "Food Stylist", icon: "fa-hamburger" },
          { name: "Actor / Modelo Presentador", icon: "fa-user-plus" },
          { name: "Community Management", icon: "fa-users" },
          { name: "Diseño/Ilustraciones", icon: "fa-palette" }
        ],
        storytellingAddons: [
          { name: "Guionista Profesional", icon: "fa-feather-alt" },
          { name: "Dirección de Arte", icon: "fa-palette" },
          { name: "Actor / Modelo Presentador", icon: "fa-user-plus" },
          { name: "Scouting de Locación", icon: "fa-map-marker-alt" },
          { name: "Influencers", icon: "fa-star" }
        ],
        editingAddons: [
          { name: "Subtítulos Animados", icon: "fa-closed-captioning" },
          { name: "Banco de Imágenes/Video", icon: "fa-images" },
          { name: "Contenido con IA", icon: "fa-robot" },
          { name: "Voz en Off", icon: "fa-microphone-alt" },
          { name: "Animaciones/Ilustraciones", icon: "fa-magic" }
        ]
      },
      // ... (resto de los objetos de serviceData sin cambios) ...
       ambientes: {
        name: "Ambientes",
        icon: "fa-building",
        videoId: "YOUTUBE_ID_AMBIENTES",
        image: "./img/genero-ambientes.jpg",
        storyIntro: "Tu espacio también cuenta una historia: luz, textura, recorrido. Hagamos que el público sienta que ya está ahí.",
        clients: ["Inmobiliaria/Agente","Hotel/Hostel/Cabaña","Arquitectura/Interiorismo","Desarrolladora","Alquiler temporal (Airbnb)","Coworking","Showroom deco"],
        scenarios: [
          { name: "Tour de Estreno", desc: "Nuevo espacio o propiedad que necesita mostrarse de forma atractiva." },
          { name: "Experiencia que Conecta", desc: "Quiero transmitir sensaciones y estilo de vida del lugar." },
          { name: "Solo Edición", desc: "Tengo material del espacio pero falta impacto y coherencia visual." },
          { name: "Guion Abierto", desc: "Tengo otra idea en mente o quiero explorar opciones." }
        ],
        levels: {
          express: { name: "Producción Express", icon: "fa-bolt", promo: true,
            desc: "<strong>Entregables:</strong> Un video-recorrido dinámico y 10 fotos. <strong>Rodaje:</strong> 1 persona, 3-4 horas, con cámara pro y lente gran angular. <strong>Promo Lanzamiento:</strong> 10 cupos a AR$ 295.000. “1 día de rodaje = 1 mes de contenido”."
          },
          indie: { name: "Producción Indie", icon: "fa-film",
            desc: "<strong>Entregables:</strong> Video-recorrido cinematográfico y 20 fotos. <strong>Rodaje:</strong> 1-2 personas, 5-6 horas, con iluminación y lentes teleobjetivo."
          },
          estelar: { name: "Producción Estelar", icon: "fa-star",
            desc: "<strong>Entregables:</strong> Spot publicitario del espacio. <strong>Rodaje:</strong> Equipo completo, jornada completa, estabilizador y Drone."
          }
        },
        editingLevels: {
          dinamica: { name: "Edición Express", icon: "fa-cut",
            desc: "<strong>Entrega:</strong> Hasta 10 piezas. Corte limpio, color y audio básico. <strong>Uso:</strong> Reels/Stories/Feed."
          },
          narrativa: { name: "Montaje Narrativo", icon: "fa-film",
            desc: "<strong>Entrega:</strong> Hasta 15 piezas. Storytelling del espacio con recorrido, detalles y ritmo."
          },
          estrategica: { name: "Edición de Campaña", icon: "fa-magic",
            desc: "<strong>Entrega:</strong> Hasta 20 piezas multiformato. Enfoque en leads/ventas y pauta."
          }
        },
        addons: [
          { name: "Actor / Modelo Presentador", icon: "fa-user-plus" },
          { name: "Drone Cinematográfico", icon: "fa-helicopter" },
          { name: "Tour Virtual 360°", icon: "fa-vr-cardboard" },
          { name: "Video Nocturno / Atardecer", icon: "fa-moon" },
          { name: "Community Management", icon: "fa-users" },
          { name: "Diseño/Ilustraciones", icon: "fa-palette" }
        ],
        editingAddons: [
          { name: "Subtítulos Animados", icon: "fa-closed-captioning" },
          { name: "Banco de Imágenes/Video", icon: "fa-images" },
          { name: "Voz en Off", icon: "fa-microphone-alt" },
          { name: "Animaciones/Ilustraciones", icon: "fa-magic" }
        ]
      },

      moda: {
        name: "Moda",
        icon: "fa-shirt",
        videoId: "YOUTUBE_ID_MODA",
        image: "./img/genero-moda.jpg",
        storyIntro: "Tu marca viste una identidad. El catálogo muestra prendas; la cámara, un mundo.",
        clients: ["Marca de indumentaria","Diseñador/a","Calzado/Marroquinería","Accesorios/Joyería","Showroom","Multimarca"],
        scenarios: [
          { name: "Colección Nueva", desc: "Lanzaste o renovaste colección, necesitás catálogo y redes." },
          { name: "Estilo que Conecta", desc: "Querés transmitir identidad y valor de marca con piezas en movimiento." },
          { name: "Solo Edición", desc: "Tenés material y querés transformarlo en contenido dinámico para redes." },
          { name: "Guion Abierto", desc: "Proyecto creativo para explorar juntos." }
        ],
        levels: {
          express: { name: "Producción Express", icon: "fa-bolt", promo: true,
            desc: "<strong>Entregables:</strong> Fotos de producto para catálogo (hasta 15 prendas). <strong>Rodaje:</strong> 1 persona, 3-4 horas. <strong>Promo Lanzamiento:</strong> 10 cupos a AR$ 295.000. “1 día de rodaje = 1 mes de contenido”."
          },
          indie: { name: "Producción Indie", icon: "fa-film",
            desc: "<strong>Entregables:</strong> Lookbook en video y fotos con modelo (hasta 30 prendas). <strong>Rodaje:</strong> 1-2 personas, 5-6 horas, con iluminación básica."
          },
          estelar: { name: "Producción Estelar", icon: "fa-star",
            desc: "<strong>Entregables:</strong> Fashion film profesional de campaña. <strong>Rodaje:</strong> Crew completa, jornada completa, dirección de arte y cámaras de cine."
          }
        },
        editingLevels: {
          dinamica: { name: "Edición Express", icon: "fa-cut",
            desc: "<strong>Entrega:</strong> Hasta 10 piezas cortas animadas (2.5D)."
          },
          narrativa: { name: "Montaje Narrativo", icon: "fa-film",
            desc: "<strong>Entrega:</strong> Hasta 15 piezas. Storytelling de colección/lookbook digital."
          },
          estrategica: { name: "Edición de Campaña", icon: "fa-magic",
            desc: "<strong>Entrega:</strong> Hasta 20 piezas. Lanzamiento, piezas para influencers y ads."
          }
        },
        addons: [
          { name: "Casting de Modelos", icon: "fa-user-plus" },
          { name: "Scouting de Locación", icon: "fa-map-marker-alt" },
          { name: "Maquillaje y Peinado", icon: "fa-air-freshener" },
          { name: "Dirección de Arte", icon: "fa-palette" },
          { name: "Community Management", icon: "fa-users" },
          { name: "Diseño/Ilustraciones", icon: "fa-palette" }
        ],
        editingAddons: [
          { name: "Subtítulos Animados", icon: "fa-closed-captioning" },
          { name: "Banco de Imágenes/Video", icon: "fa-images" },
          { name: "Contenido con IA", icon: "fa-robot" },
          { name: "Voz en Off", icon: "fa-microphone-alt" },
          { name: "Animaciones/Ilustraciones", icon: "fa-magic" }
        ]
      },

      "marca-personal": {
        name: "Marca Personal",
        icon: "fa-user-tie",
        videoId: "YOUTUBE_ID_MARCA_PERSONAL",
        image: "./img/genero-marca-personal.jpg",
        storyIntro: "Tu voz es la historia. Te filmamos para que conecte más y mejor.",
        clients: ["Influencer/Creator","Coach/Consultor","Profesional independiente","Salud/Wellness","Docente/Formador","Orador/Conferencista","Artista"],
        scenarios: [
          { name: "Presentación de Estreno", desc: "Necesito un video 'Quién Soy' que genere confianza." },
          { name: "Autoridad que Conecta", desc: "Quiero una serie de videos cortos para posicionarme." },
          { name: "Solo Edición", desc: "Tengo material largo (streams/charlas) y quiero clips virales." },
          { name: "Guion Abierto", desc: "Tengo otra idea en mente o busco exploración creativa." }
        ],
        levels: {
          express: { name: "Producción Express", icon: "fa-bolt", promo: true,
            desc: "<strong>Entregables:</strong> 1 video 'Quién Soy' + 5 clips. <strong>Rodaje:</strong> 1 persona, 2-3 horas, cámara y sonido profesional. <strong>Promo Lanzamiento:</strong> 10 cupos a AR$ 295.000. “1 día de rodaje = 1 mes de contenido”."
          },
          indie: { name: "Producción Indie", icon: "fa-film",
            desc: "<strong>Entregables:</strong> Serie de 10-12 videos cortos. <strong>Rodaje:</strong> 1-2 personas, 4-5 horas, iluminación básica/teleprompter."
          },
          estelar: { name: "Producción Estelar", icon: "fa-star",
            desc: "<strong>Entregables:</strong> Mini-docu o Masterclass. <strong>Rodaje:</strong> Crew completa, jornada completa, multicámara."
          }
        },
        editingLevels: {
          dinamica: { name: "Edición Express", icon: "fa-cut",
            desc: "<strong>Entrega:</strong> Hasta 10 clips con cortes, subtítulos y música."
          },
          narrativa: { name: "Montaje Narrativo", icon: "fa-film",
            desc: "<strong>Entrega:</strong> Hasta 15 piezas con estructura educativa/inspiradora."
          },
          estrategica: { name: "Edición de Campaña", icon: "fa-magic",
            desc: "<strong>Entrega:</strong> Hasta 20 piezas para lanzamiento de curso/servicio."
          }
        },
        addons: [
          { name: "Guionista Profesional", icon: "fa-feather-alt" },
          { name: "Animaciones / Efectos", icon: "fa-magic" },
          { name: "Diseño de Miniaturas", icon: "fa-image" },
          { name: "Asesoría de Imagen", icon: "fa-user-check" },
          { name: "Community Management", icon: "fa-users" },
          { name: "Diseño/Ilustraciones", icon: "fa-palette" }
        ],
        editingAddons: [
          { name: "Subtítulos Animados", icon: "fa-closed-captioning" },
          { name: "Banco de Imágenes/Video", icon: "fa-images" },
          { name: "Contenido con IA", icon: "fa-robot" },
          { name: "Voz en Off", icon: "fa-microphone-alt" },
          { name: "Animaciones/Ilustraciones", icon: "fa-magic" }
        ]
      },

      servicios: {
        name: "Servicios",
        icon: "fa-handshake",
        videoId: "YOUTUBE_ID_SERVICIOS",
        image: "./img/genero-servicios.jpg",
        storyIntro: "Mostremos tu oficio en acción. Que el cliente vea, entienda y confíe.",
        clients: ["Peluquería/Barbería","Estética/Spa","Tatuajes","Detailing/Autos","Limpieza","Veterinaria","Servicios a domicilio"],
        scenarios: [
          { name: "Showroom de Oficio", desc: "Quiero que vean mi trabajo en acción (antes/después, proceso)." },
          { name: "Confianza que Conecta", desc: "Necesito transmitir profesionalismo y testimonios reales." },
          { name: "Solo Edición", desc: "Tengo material y necesito edición profesional." },
          { name: "Guion Abierto", desc: "Busco ideas o formatos que me diferencien." }
        ],
        levels: {
          express: { name: "Producción Express", icon: "fa-bolt", promo: true,
            desc: "<strong>Entregables:</strong> Clips de proceso y 10 fotos. <strong>Rodaje:</strong> 1 persona, 3-4 horas. <strong>Promo Lanzamiento:</strong> 10 cupos a AR$ 295.000. “1 día de rodaje = 1 mes de contenido”."
          },
          indie: { name: "Producción Indie", icon: "fa-film",
            desc: "<strong>Entregables:</strong> Video explicativo + entrevistas breves. <strong>Rodaje:</strong> 1-2 personas, 5-6 horas, iluminación y sonido pro."
          },
          estelar: { name: "Producción Estelar", icon: "fa-star",
            desc: "<strong>Entregables:</strong> Spot publicitario de tu servicio. <strong>Rodaje:</strong> Equipo completo, jornada completa, estilo cine."
          }
        },
        editingLevels: {
          dinamica: { name: "Edición Express", icon: "fa-cut",
            desc: "<strong>Ideal:</strong> Placas/carruseles/shorts. Diseño y banco de imagen."
          },
          narrativa: { name: "Video con IA", icon: "fa-robot",
            desc: "<strong>Ideal:</strong> Generar videos cortos desde texto o imágenes. Guion + generación + edición."
          },
          estrategica: { name: "Estrategia Completa", icon: "fa-magic",
            desc: "<strong>Ideal:</strong> Plan mensual 100% digital. Diseño, copy, videos con IA y community."
          }
        },
        addons: [
          { name: "Videos Testimoniales", icon: "fa-comment-dots" },
          { name: "Fotografía Profesional", icon: "fa-camera-retro" },
          { name: "Voz en Off Profesional", icon: "fa-microphone-alt" },
          { name: "Guionista", icon: "fa-feather-alt" },
          { name: "Community Management", icon: "fa-users" },
          { name: "Diseño/Ilustraciones", icon: "fa-palette" }
        ],
        editingAddons: [
          { name: "Subtítulos Animados", icon: "fa-closed-captioning" },
          { name: "Banco de Imágenes/Video", icon: "fa-images" },
          { name: "Copywriting para Redes", icon: "fa-pencil-alt" },
          { name: "Animaciones/Ilustraciones", icon: "fa-magic" }
        ]
      },

      comercios: {
        name: "Comercios",
        icon: "fa-store",
        videoId: "YOUTUBE_ID_COMERCIOS",
        image: "./img/genero-comercios.jpg",
        storyIntro: "Tu local es una película en movimiento: productos, personas y experiencia.",
        clients: ["Tienda física","E-commerce","Florería/Vivero","Dietética","Pet Shop","Librería/Juguetería","Delicatessen/Vinoteca","Vintage/Segunda mano"],
        scenarios: [
          { name: "Vidriera Digital", desc: "Necesito fotos y videos de mis productos y del local para atraer público online y presencial." },
          { name: "La Experiencia de Compra", desc: "Quiero mostrar atención, ambiente y por qué visitarnos vale la pena." },
          { name: "Solo Edición", desc: "Tengo catálogo y clips, falta edición pro." },
          { name: "Guion Abierto", desc: "Prefiero una producción personalizada." }
        ],
        levels: {
          express: { name: "Producción Express", icon: "fa-bolt", promo: true,
            desc: "<strong>Entregables:</strong> Pack de fotos y videos de tus productos más vendidos (hasta 15). <strong>Rodaje:</strong> 1 persona, 3-4 horas. <strong>Promo Lanzamiento:</strong> 10 cupos a AR$ 295.000. “1 día de rodaje = 1 mes de contenido”."
          },
          indie: { name: "Producción Indie", icon: "fa-film",
            desc: "<strong>Entregables:</strong> Videos que muestren la experiencia de visitar tu local. <strong>Rodaje:</strong> 1-2 personas, 5-6 horas, iluminación para ambiente."
          },
          estelar: { name: "Producción Estelar", icon: "fa-star",
            desc: "<strong>Entregables:</strong> Spot publicitario del comercio. <strong>Rodaje:</strong> Equipo completo, jornada completa, estilo cine."
          }
        },
        editingLevels: {
          dinamica: { name: "Edición Express", icon: "fa-cut",
            desc: "<strong>Entrega:</strong> Hasta 10 piezas de catálogo. Corte y color."
          },
          narrativa: { name: "Montaje Narrativo", icon: "fa-film",
            desc: "<strong>Entrega:</strong> Hasta 15 piezas con storytelling de producto + experiencia."
          },
          estrategica: { name: "Edición de Campaña", icon: "fa-magic",
            desc: "<strong>Entrega:</strong> Hasta 20 piezas para promos/lanzamientos y ads."
          }
        },
        addons: [
          { name: "Fotografía de Producto", icon: "fa-camera" },
          { name: "Videos UGC (Clientes)", icon: "fa-users" },
          { name: "Recorrido del Local", icon: "fa-walking" },
          { name: "Diseño para Redes", icon: "fa-palette" },
          { name: "Community Management", icon: "fa-users" },
          { name: "Diseño/Ilustraciones", icon: "fa-palette" }
        ],
        editingAddons: [
          { name: "Subtítulos Animados", icon: "fa-closed-captioning" },
          { name: "Banco de Imágenes/Video", icon: "fa-images" },
          { name: "Voz en Off", icon: "fa-microphone-alt" },
          { name: "Animaciones/Ilustraciones", icon: "fa-magic" }
        ]
      },

      eventos: {
        name: "Eventos",
        icon: "fa-ticket",
        videoId: "YOUTUBE_ID_EVENTOS",
        image: "./img/genero-eventos.jpg",
        storyIntro: "Hay un antes, un clímax y un después. Lo registramos con alma de aftermovie.",
        clients: ["Fiesta/Social","Corporativo","Concierto/Live show","Feria/Congreso","Festival","Activación/Lanzamiento"],
        scenarios: [
          { name: "El Tráiler", desc: "Video promocional para vender entradas y generar expectativa." },
          { name: "El Aftermovie", desc: "Resumen que capture energía y mejores momentos." },
          { name: "Solo Edición", desc: "Tengo material y necesito un montaje profesional." },
          { name: "Guion Abierto", desc: "Otro formato en mente." }
        ],
        levels: {
          express: { name: "Producción Express", icon: "fa-bolt", promo: true,
            desc: "<strong>Entregables:</strong> Reel promo o after corto. <strong>Rodaje:</strong> 1 persona, 3-4 horas de cobertura. <strong>Promo Lanzamiento:</strong> 10 cupos a AR$ 295.000. “1 día de rodaje = 1 mes de contenido”."
          },
          indie: { name: "Producción Indie", icon: "fa-film",
            desc: "<strong>Entregables:</strong> Cobertura con entrevistas. <strong>Rodaje:</strong> 1-2 personas, 5-6 horas, mejor audio e iluminación."
          },
          estelar: { name: "Producción Estelar", icon: "fa-star",
            desc: "<strong>Entregables:</strong> Aftermovie cinematográfico. <strong>Rodaje:</strong> Crew completa, cobertura total, multicámara, drone, steady."
          }
        },
        editingLevels: {
          dinamica: { name: "Edición Express", icon: "fa-cut",
            desc: "<strong>Ideal:</strong> Reels y piezas cortas. Música y cortes dinámicos."
          },
          narrativa: { name: "Montaje Narrativo", icon: "fa-film",
            desc: "<strong>Ideal:</strong> Aftermovie oficial con historia y highlights."
          },
          estrategica: { name: "Campaña Estratégica", icon: "fa-magic",
            desc: "<strong>Ideal:</strong> Serie post-evento (entrevistas, teasers para próxima edición)."
          }
        },
        addons: [
          { name: "Influencer / Host", icon: "fa-star" },
          { name: "Transmisión en Vivo (Stream)", icon: "fa-video" },
          { name: "Fotografía del Evento", icon: "fa-camera-retro" },
          { name: "Dirección de Arte", icon: "fa-palette" },
          { name: "Community Management", icon: "fa-users" },
          { name: "Diseño/Ilustraciones", icon: "fa-palette" }
        ],
        editingAddons: [
          { name: "Subtítulos Animados", icon: "fa-closed-captioning" },
          { name: "Banco de Imágenes/Video", icon: "fa-images" },
          { name: "Contenido con IA", icon: "fa-robot" },
          { name: "Voz en Off", icon: "fa-microphone-alt" },
          { name: "Animaciones/Ilustraciones", icon: "fa-magic" }
        ]
      },

      "grandes-marcas": {
        name: "Grandes Marcas",
        icon: "fa-crown",
        videoId: "YOUTUBE_ID_MARCAS",
        image: "./img/genero-marcas.jpg",
        storyIntro: "Contenido ágil con estándar de campaña. Del always-on al lanzamiento.",
        clients: ["Consumo masivo","Retail/Franquicia","Tech/SaaS","Automotriz","Laboratorio","ONG/Fundación","B2B Industrial"],
        scenarios: [
          { name: "Always On Mensual", desc: "Contenido constante y de alta calidad para mantener redes activas." },
          { name: "Campaña de Lanzamiento", desc: "Nuevo producto o gran anuncio con piezas de alto impacto." },
          { name: "Guion Abierto", desc: "Brief flexible para cocrear." }
        ],
        levels: {
          express: { name: "Producción Express", icon: "fa-bolt", promo: true,
            desc: "<strong>Entregables:</strong> Paquete mensual (Reels/Stories) con foco en consistencia. <strong>Rodaje:</strong> Ágil y planificado. <strong>Promo Lanzamiento:</strong> 10 cupos a AR$ 295.000. “1 día de rodaje = 1 mes de contenido”."
          },
          indie: { name: "Producción Indie", icon: "fa-film",
            desc: "<strong>Entregables:</strong> Contenido mensual con mayor elaboración y planificación estratégica. <strong>Rodaje:</strong> Jornadas completas con equipo profesional."
          },
          estelar: { name: "Producción Estelar", icon: "fa-star",
            desc: "<strong>Entregables:</strong> Campaña publicitaria con calidad cine. <strong>Rodaje:</strong> Pre, rodaje y post de alto nivel."
          }
        },
        editingLevels: {
          dinamica: { name: "Edición Express", icon: "fa-cut",
            desc: "<strong>Entrega:</strong> Hasta 10 piezas para always-on, ajuste rápido con consistencia de marca."
          },
          narrativa: { name: "Montaje Narrativo", icon: "fa-film",
            desc: "<strong>Entrega:</strong> Hasta 15 piezas cohesionadas por historia/beneficio."
          },
          estrategica: { name: "Edición de Campaña", icon: "fa-magic",
            desc: "<strong>Entrega:</strong> Hasta 20 piezas 360 (feed, stories, ads) orientadas a objetivos."
          }
        },
        addons: [
          { name: "Estrategia de Contenido", icon: "fa-chess-board" },
          { name: "Dirección de Arte", icon: "fa-palette" },
          { name: "Música Original", icon: "fa-music" },
          { name: "Gestión de Pauta", icon: "fa-bullhorn" },
          { name: "Community Management", icon: "fa-users" },
          { name: "Diseño/Ilustraciones", icon: "fa-palette" }
        ],
        editingAddons: [
          { name: "Subtítulos Animados", icon: "fa-closed-captioning" },
          { name: "Banco de Imágenes/Video", icon: "fa-images" },
          { name: "Voz en Off", icon: "fa-microphone-alt" },
          { name: "Animaciones/Ilustraciones", icon: "fa-magic" }
        ]
      }
    };
    // ===================== FIN CONTENIDO EDITABLE =====================

    const state = { genre: null, scenario: null, level: null, addons: new Set(), clientTypes: new Set() };
    const sections = {
      step2: document.getElementById('step2'),
      step3: document.getElementById('step3'),
      step5: document.getElementById('step5')
    };

    function showSection(id){ if(sections[id]){ sections[id].classList.remove('section-hidden'); sections[id].classList.add('section-visible'); } }

    function renderGenres(){
      const container = document.getElementById('genre-selector');
      container.innerHTML='';
      for(const key in serviceData){
        const g = serviceData[key];
        const card = document.createElement('div');
        card.className="genre-card movie-poster-card relative rounded-lg overflow-hidden cursor-pointer border-2 border-transparent";
        card.dataset.genre=key;
        card.style.backgroundImage = `url(${g.image})`;
        card.innerHTML = `
          <div class="movie-poster-overlay absolute inset-0 flex flex-col items-center justify-end p-4 text-center">
            <i class="fas ${g.icon} text-2xl mb-2"></i>
            <h3 class="text-lg font-bold">${g.name}</h3>
          </div>`;
        card.addEventListener('click',()=>selectGenre(key));
        container.appendChild(card);
      }
    }

    function selectGenre(key){
      state.genre = key; state.scenario=null; state.level=null; state.addons.clear(); state.clientTypes.clear();
      document.querySelectorAll('.genre-card').forEach(c=>c.classList.remove('border-brick-red','ring-4'));
      document.querySelector(`[data-genre="${key}"]`).classList.add('border-brick-red','ring-4');

      const videoId = serviceData[key].videoId;
      document.getElementById('hero-video-iframe').src = `https://www.youtube.com/embed/${videoId}?autoplay=1&mute=1&loop=1&playlist=${videoId}&controls=0&showinfo=0&autohide=1&modestbranding=1&vq=hd1080`;

      renderScenarios(key);
      updateSummary();
      showSection('step2');
      sections.step2.scrollIntoView({behavior:'smooth', block:'start'});
    }

    function renderScenarios(genreKey){
      const wrapper = document.getElementById('scenario-container');
      wrapper.innerHTML='';
      const g = serviceData[genreKey];

      const storytelling = document.createElement('div');
      storytelling.className="md:col-span-2 lg:col-span-3 bg-gray-800/40 border border-gray-800 rounded-lg p-5 text-left";
      
      let clientsListHTML = '';
      if (g.clients && g.clients.length > 0) {
          clientsListHTML += '<div class="mt-2"><p class="text-gray-400 text-sm mb-2">Podrías ser:</p><div class="flex flex-wrap gap-2">';
          g.clients.forEach(client => {
              clientsListHTML += `
                  <label class="flex items-center space-x-2 cursor-pointer p-2 rounded-md hover:bg-gray-700 transition-all text-sm border border-gray-700">
                      <input type="checkbox" class="client-type-checkbox h-4 w-4 bg-gray-700 border-gray-600 rounded-sm text-brick-red focus:ring-brick-red" data-name="${client}">
                      <span>${client}</span>
                  </label>
              `;
          });
          clientsListHTML += '</div></div>';
      }

      storytelling.innerHTML = `
        <p class="text-gray-300 mb-3"><strong>Esta historia se escribe en el género ${g.name.toUpperCase()}.</strong> ${g.storyIntro||''}</p>
        ${clientsListHTML}
        <p class="text-gray-400 mt-4">Ahora, ubiquemos <em>en qué punto de la historia</em> estás:</p>`;
      wrapper.appendChild(storytelling);

      document.querySelectorAll('.client-type-checkbox').forEach(cb => {
          cb.addEventListener('change', (e) => {
              if (e.target.checked) {
                  state.clientTypes.add(e.target.dataset.name);
              } else {
                  state.clientTypes.delete(e.target.dataset.name);
              }
              updateSummary();
          });
      });

      g.scenarios.forEach((sc, i)=>{
        const card = document.createElement('div');
        card.className="scenario-card bg-gray-900 p-6 rounded-lg border-2 border-gray-800 flex flex-col cursor-pointer hover:border-brick-red transition-all";
        card.dataset.scenarioIndex=i;
        card.innerHTML = `<h3 class="text-xl font-bold text-brick-red">${sc.name}</h3><p class="text-gray-400 mt-2 flex-grow">${sc.desc}</p>`;
        card.addEventListener('click',()=>selectScenario(i));
        wrapper.appendChild(card);
      });
    }

    function selectScenario(index){
      state.scenario = serviceData[state.genre].scenarios[index];
      state.level=null; state.addons.clear();

      document.querySelectorAll('.scenario-card').forEach(c=>c.classList.remove('border-brick-red','ring-2'));
      document.querySelector(`[data-scenario-index="${index}"]`).classList.add('border-brick-red','ring-2');

      const isDigital = state.scenario.name.toLowerCase().includes('edición');
      const isStorytelling = state.scenario.name.toLowerCase().includes('sabor que conecta');
      
      renderLevels(isDigital, isStorytelling);
      updateSummary();
      showSection('step3');
      sections.step3.scrollIntoView({behavior:'smooth', block:'start'});
    }

    function renderLevels(isDigital, isStorytelling){
      const container = document.getElementById('level-container');
      const title = document.getElementById('step3-title');
      const subtitle = document.getElementById('step3-subtitle');
      container.innerHTML='';

      const g = serviceData[state.genre];
      let levels;
      
      if (isStorytelling) {
        levels = g.storytellingLevels;
        title.textContent = 'Ladrillo Tres: Definí el Nivel del Relato';
        subtitle.textContent = 'Desde un guion para redes hasta una campaña 360.';
      } else if (isDigital) {
        levels = g.editingLevels;
        title.textContent = 'Ladrillo Tres: Definí el nivel de post-producción';
        subtitle.textContent = 'Desde clips rápidos hasta una post-producción de cine.';
      } else {
        levels = g.levels;
        title.textContent = 'Ladrillo Tres: Definí el nivel de producción';
        subtitle.textContent = 'Desde una escena clave hasta una superproducción.';
      }

      for(const key in levels){
        const lv = levels[key];
        const card = document.createElement('div');
        card.className="level-card relative bg-gray-900 p-6 rounded-lg border-2 border-gray-800 flex flex-col cursor-pointer hover:border-brick-red transition-all text-left";
        card.dataset.levelKey=key;

        card.innerHTML = `
          ${lv.promo ? `<div class="badge-promo">LANZAMIENTO · 10 cupos · $295.000</div>` : ''}
          <i class="fas ${lv.icon} text-3xl text-brick-red mb-4"></i>
          <h3 class="text-xl font-bold">${lv.name}</h3>
          <p class="text-gray-400 mt-2 flex-grow">${lv.desc}</p>
        `;
        card.addEventListener('click',()=>selectLevel(key, isDigital, isStorytelling));
        container.appendChild(card);
      }
    }

    function selectLevel(key, isDigital, isStorytelling){
      const g = serviceData[state.genre];
      let levels;
      if (isStorytelling) {
          levels = g.storytellingLevels;
      } else if (isDigital) {
          levels = g.editingLevels;
      } else {
          levels = g.levels;
      }
      state.level = levels[key]; 
      state.addons.clear();

      document.querySelectorAll('.level-card').forEach(c=>c.classList.remove('border-brick-red','ring-2'));
      document.querySelector(`[data-level-key="${key}"]`).classList.add('border-brick-red','ring-2');

      updateSummary();
      showSection('step5');
      sections.step5.scrollIntoView({behavior:'smooth', block:'start'});
    }

    function renderAddons(isDigital, isStorytelling){
      const container = document.getElementById('addons-container');
      container.innerHTML=''; 

      const g = serviceData[state.genre];
      let addons;

      if (isStorytelling) {
        addons = g.storytellingAddons;
      } else if (isDigital) {
        addons = g.editingAddons;
      } else {
        addons = g.addons;
      }

      if (!addons || addons.length === 0) {
        container.style.display = 'none';
        return;
      }
      container.style.display = 'block';

      const titleText = isDigital ? 'Potenciá tu Edición' : 'Armá tu Historia';
      const subtitleText = isDigital ? 'Agregá herramientas y efectos para un resultado final increíble.' : 'Imaginá tu producción ideal. Agregá personajes y efectos especiales.';

      let html = `<div class="pt-6 border-t border-gray-700">
                      <h3 class="text-xl font-bold mb-2">Ladrillos Extras: ${titleText}</h3>
                      <p class="text-gray-400 mb-6 text-sm">${subtitleText}</p>
                      <div class="grid sm:grid-cols-2 gap-4">`;

      addons.forEach(a => {
          const isChecked = state.addons.has(a.name) ? 'checked' : '';
          html += `
            <label class="flex items-center space-x-3 cursor-pointer p-3 rounded-md hover:bg-gray-800 transition-all">
              <input type="checkbox" class="addon-checkbox h-5 w-5 bg-gray-700 border-gray-600 rounded-sm text-brick-red focus:ring-brick-red" data-name="${a.name}" ${isChecked}>
              <i class="fas ${a.icon} text-gray-400 w-5 text-center"></i>
              <span>${a.name}</span>
            </label>`;
      });

      html += '</div></div>';
      container.innerHTML = html;

      document.querySelectorAll('.addon-checkbox').forEach(cb => cb.addEventListener('change', (e) => toggleAddon(e.target.dataset.name, e.target.checked)));
    }

    function toggleAddon(name, checked){ 
      if(checked) state.addons.add(name); 
      else state.addons.delete(name); 
      updateSummary(true); // Pass flag to avoid re-rendering addons
    }

    function updateSummary(addonsChanged = false){
      const summaryContainer = document.getElementById('summary-content');
      const addonsContainer = document.getElementById('addons-container');
      const shareBtn = document.getElementById('share-button');
      const submitBtn = document.getElementById('submit-button');

      if(!state.genre || !state.scenario || !state.level){
        summaryContainer.innerHTML = '<p class="text-gray-500">Completá los pasos para ver tu plan de producción.</p>';
        addonsContainer.innerHTML = '';
        submitBtn.disabled = true; shareBtn.disabled = true; return;
      }
      
      shareBtn.disabled = false;
      let html = '';

      if (state.genre) html += `<p><strong>Género:</strong> ${serviceData[state.genre].name}</p>`;
      if (state.clientTypes.size > 0) html += `<p class="mt-2"><strong>Tipo de Marca:</strong> ${[...state.clientTypes].join(', ')}</p>`;
      if (state.scenario) html += `<p class="mt-2"><strong>Escenario:</strong> ${state.scenario.name}</p>`;
      
      if (state.level) {
        html += `<div class="mt-4 pt-4 border-t border-gray-700">
                  <h4 class="font-bold text-lg mb-2">${state.level.name}</h4>
                  <div class="text-gray-400 text-sm space-y-2">${state.level.desc}</div>
               </div>`;
        if (state.addons.size > 0) {
            html += '<p class="mt-4"><strong>Ladrillos Extras:</strong></p><ul class="list-disc list-inside text-gray-400 text-sm">';
            state.addons.forEach(a=> html += `<li>${a}</li>`);
            html += '</ul>';
        }
      }

      summaryContainer.innerHTML = html;

      if (!addonsChanged) {
        const isDigital = state.scenario.name.toLowerCase().includes('edición');
        const isStorytelling = state.scenario.name.toLowerCase().includes('sabor que conecta');
        renderAddons(isDigital, isStorytelling);
      }
      
      const isExpress = state.level.promo || false;
      submitBtn.textContent = isExpress ? 'Reservar Cupo Promocional' : 'Coordinar Reunión Creativa';
      
      validateForm();
    }

    function validateForm(){
      const ok = state.level && document.getElementById('client-name').value && document.getElementById('client-email').value && document.getElementById('client-business').value;
      document.getElementById('submit-button').disabled = !ok;
    }
    
    // ===== LÓGICA DE ENVÍO PARA NETLIFY =====
    document.getElementById('client-form').addEventListener('submit', function(e) {
        e.preventDefault(); // Previene la recarga de la página

        // 1. Actualizamos el campo oculto con el resumen de texto plano
        const summaryDiv = document.getElementById('summary-content');
        // Clonamos el div para no modificar el original
        const summaryClone = summaryDiv.cloneNode(true);
        // Reemplazamos los <br> y otros tags por saltos de línea para que se lea bien
        summaryClone.innerHTML = summaryClone.innerHTML.replace(/<br\s*[\/]?>/gi, "\n").replace(/<p.*?>/gi, "").replace(/<\/p>/gi, "\n");
        document.getElementById('hidden-summary-input').value = summaryClone.innerText.trim();

        // 2. Preparamos los datos para Netlify
        const formData = new FormData(this);
        const formBody = new URLSearchParams(formData).toString();
        const submitButton = document.getElementById('submit-button');
        
        submitButton.disabled = true;
        submitButton.textContent = 'Enviando...';

        // 3. Enviamos el formulario con fetch
        fetch("/", {
            method: "POST",
            headers: { "Content-Type": "application/x-www-form-urlencoded" },
            body: formBody
        })
        .then(() => {
            submitButton.textContent = '¡Enviado con Éxito!';
            // Opcional: podrías mostrar un mensaje de éxito en otro lugar de la página
        })
        .catch((error) => {
            alert("Hubo un error al enviar tu solicitud. Por favor, intenta de nuevo.");
            submitButton.disabled = false;
            submitButton.textContent = 'Reintentar Envío';
        });
    });

    // Asegúrate de que el listener de validación sigue existiendo
    document.getElementById('client-form').addEventListener('input', validateForm);
    // ===== FIN DE LÓGICA DE NETLIFY =====


    // Compartir
    const shareButton = document.getElementById('share-button');
    const shareModal = document.getElementById('share-modal');
    const closeModalButton = document.getElementById('close-modal-button');
    const copyLinkButton = document.getElementById('copy-link-button');
    const shareLinkInput = document.getElementById('share-link-input');

    shareButton.addEventListener('click', ()=>{
      const baseUrl = window.location.href.split('?')[0];
      let params = `?g=${state.genre}`;
      const scIndex = serviceData[state.genre].scenarios.findIndex(s=>s.name===state.scenario.name);
      params += `&s=${scIndex}`;

      const isDigital = state.scenario.name.toLowerCase().includes('edición');
      const isStorytelling = state.scenario.name.toLowerCase().includes('sabor que conecta');
      
      let levels;
      let currentAddonsList;

      if(isStorytelling) {
        levels = serviceData[state.genre].storytellingLevels;
        currentAddonsList = serviceData[state.genre].storytellingAddons;
      } else if (isDigital) {
        levels = serviceData[state.genre].editingLevels;
        currentAddonsList = serviceData[state.genre].editingAddons;
      } else {
        levels = serviceData[state.genre].levels;
        currentAddonsList = serviceData[state.genre].addons;
      }
      
      const levelKey = Object.keys(levels).find(k=> levels[k].name===state.level.name);
      params += `&l=${levelKey}`;

      if(state.addons.size > 0 && currentAddonsList){
        const currentAddons = currentAddonsList.map(a=>a.name);
        const indices = [];
        state.addons.forEach(n=>{ const i=currentAddons.indexOf(n); if(i>-1) indices.push(i); });
        params += `&a=${indices.join(',')}`;
      }
      shareLinkInput.value = baseUrl + params;
      shareModal.classList.remove('hidden');
    });
    closeModalButton.addEventListener('click', ()=> shareModal.classList.add('hidden'));
    copyLinkButton.addEventListener('click', ()=>{
      shareLinkInput.select(); document.execCommand('copy');
      copyLinkButton.textContent = '¡Copiado!'; setTimeout(()=> copyLinkButton.textContent='Copiar', 2000);
    });

    // Deep link
    function readUrlParams(){
      const params = new URLSearchParams(window.location.search);
      const genre = params.get('g'); const scenarioIdx = params.get('s'); const levelKey = params.get('l'); const addons = params.get('a');
      if(genre && serviceData[genre]){
        selectGenre(genre);
        const scenario = serviceData[genre].scenarios[scenarioIdx];
        if(scenario){
          selectScenario(scenarioIdx);
          
          const isDigital = scenario.name.toLowerCase().includes('edición');
          const isStorytelling = scenario.name.toLowerCase().includes('sabor que conecta');
          
          let levels;
          let currentAddonsList;

          if(isStorytelling) {
            levels = serviceData[genre].storytellingLevels;
            currentAddonsList = serviceData[genre].storytellingAddons;
          } else if (isDigital) {
            levels = serviceData[genre].editingLevels;
            currentAddonsList = serviceData[genre].editingAddons;
          } else {
            levels = serviceData[genre].levels;
            currentAddonsList = serviceData[genre].addons;
          }

          if(levelKey && levels[levelKey]){
            selectLevel(levelKey, isDigital, isStorytelling);
            if(addons && currentAddonsList){
              const idx = addons.split(',');
              const boxes = document.querySelectorAll('.addon-checkbox');
              idx.forEach(i=>{
                const name = currentAddonsList[i]?.name;
                if(name){ 
                  state.addons.add(name); 
                  boxes.forEach(cb=>{ if(cb.dataset.name===name) cb.checked = true; }); 
                }
              });
              updateSummary(true);
            }
          }
        }
      }
    }

    renderGenres();
    readUrlParams();
  });
  </script>
</body>
</html>
